{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Data wrangling on [people_data.csv](https://piazza.com/redirect/s3?bucket=uploads&prefix=attach%2Fjsagy1god6f2bq%2Fjdl2dukjx9e4n9%2Fjswf28nz9jht%2Fpeople_data.csv) by `Mostafa Tarek` using `MongoDB`, `Pymongo` "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "__vis the data and assessing it__"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>firstname</th>\n",
       "      <th>lastname</th>\n",
       "      <th>age</th>\n",
       "      <th>currentJob</th>\n",
       "      <th>prevJobs</th>\n",
       "      <th>friendsID</th>\n",
       "      <th>hobbies</th>\n",
       "      <th>email</th>\n",
       "      <th>nationality</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>magdi</td>\n",
       "      <td>abd elrahman</td>\n",
       "      <td>35.0</td>\n",
       "      <td>Surveying and Mapping Technicians</td>\n",
       "      <td>Agricultural Engineers,Wind Energy Engineers</td>\n",
       "      <td>712,6592,7375</td>\n",
       "      <td>competitive programming,competitive programming</td>\n",
       "      <td>NaN</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>samir</td>\n",
       "      <td>tamer</td>\n",
       "      <td>84.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Fuel Cell Engineers,Materials Engineers</td>\n",
       "      <td>1139,2309,2767,3343,9150,9533,9845</td>\n",
       "      <td>NaN</td>\n",
       "      <td>samirtamer1626@gmail.com</td>\n",
       "      <td>syrian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>eslam</td>\n",
       "      <td>rashad</td>\n",
       "      <td>74.0</td>\n",
       "      <td>Mapping Technicians</td>\n",
       "      <td>NaN</td>\n",
       "      <td>462,720,3195,3836,4704</td>\n",
       "      <td>football</td>\n",
       "      <td>rashadeslam6970@yahoo.com</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>ali</td>\n",
       "      <td>eslam</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Health and Safety Engineers, Except Mining Saf...</td>\n",
       "      <td>Electro-Mechanical Technicians</td>\n",
       "      <td>1659,3995,6073</td>\n",
       "      <td>football,camping</td>\n",
       "      <td>eslamali1859@gmail.com</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>ehab</td>\n",
       "      <td>maher</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Photonics Engineers</td>\n",
       "      <td>Agricultural Engineers,Marine Engineers</td>\n",
       "      <td>2090,7126</td>\n",
       "      <td>cooking,swimming</td>\n",
       "      <td>NaN</td>\n",
       "      <td>syrian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>yosra</td>\n",
       "      <td>ibrahim</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Validation Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4220</td>\n",
       "      <td>swimming,football</td>\n",
       "      <td>NaN</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6</td>\n",
       "      <td>mona</td>\n",
       "      <td>Arshd</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Mechatronics Engineers</td>\n",
       "      <td>Chemical Engineers,Petroleum Engineers</td>\n",
       "      <td>498,1245,2567,6508,9255</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>moroccan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>yosra</td>\n",
       "      <td>ibrahim</td>\n",
       "      <td>38.0</td>\n",
       "      <td>Energy Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2567,3746,4563,5207,9662,9695</td>\n",
       "      <td>NaN</td>\n",
       "      <td>yosraibrahim4119@hotmail.com</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>8</td>\n",
       "      <td>mai</td>\n",
       "      <td>mazen</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Civil Engineers,Nanotechnology Engineering Tec...</td>\n",
       "      <td>992,4719,6870</td>\n",
       "      <td>cooking</td>\n",
       "      <td>mazenmai7201@yahoo.com</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>9</td>\n",
       "      <td>sanaa</td>\n",
       "      <td>samy</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Environmental Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5150,5842,8582,9426</td>\n",
       "      <td>football</td>\n",
       "      <td>NaN</td>\n",
       "      <td>syrian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>10</td>\n",
       "      <td>rashad</td>\n",
       "      <td>amer</td>\n",
       "      <td>33.0</td>\n",
       "      <td>Marine Engineers and Naval Architects</td>\n",
       "      <td>Electrical Engineers</td>\n",
       "      <td>499,2455,3709,8276</td>\n",
       "      <td>competitive programming</td>\n",
       "      <td>amerrashad2991@gmail.com</td>\n",
       "      <td>moroccan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>11</td>\n",
       "      <td>shady</td>\n",
       "      <td>Arshd</td>\n",
       "      <td>69.0</td>\n",
       "      <td>Biochemical Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>378,2587,3169,4845</td>\n",
       "      <td>swimming,swimming</td>\n",
       "      <td>shadyArshd6821@yahoo.com</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>ibrahim</td>\n",
       "      <td>tamer</td>\n",
       "      <td>21.0</td>\n",
       "      <td>Chemical Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>689,4954,7664,8520</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ibrahimtamer1165@gmail.com</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>13</td>\n",
       "      <td>abd elrahman</td>\n",
       "      <td>Arshd</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Wind Energy Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1356,3870</td>\n",
       "      <td>reading,drawing</td>\n",
       "      <td>NaN</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>14</td>\n",
       "      <td>tamer</td>\n",
       "      <td>ehab</td>\n",
       "      <td>59.0</td>\n",
       "      <td>Industrial Engineering Technicians</td>\n",
       "      <td>Water/Wastewater Engineers,Manufacturing Engin...</td>\n",
       "      <td>1969,2907,6168,9808</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>15</td>\n",
       "      <td>yosra</td>\n",
       "      <td>hosny</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Electro-Mechanical Technicians</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7339,7687,8055,8987,9648,9995</td>\n",
       "      <td>tennis,tennis</td>\n",
       "      <td>yosrahosny2683@yahoo.com</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>ibrahim</td>\n",
       "      <td>hatem</td>\n",
       "      <td>58.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Manufacturing Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>reading,watching movies</td>\n",
       "      <td>NaN</td>\n",
       "      <td>jordanian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>ibrahim</td>\n",
       "      <td>abd allah</td>\n",
       "      <td>50.0</td>\n",
       "      <td>Surveying Technicians</td>\n",
       "      <td>Civil Engineers,Manufacturing Engineering Tech...</td>\n",
       "      <td>4155,7422,8466,9813</td>\n",
       "      <td>tennis,football</td>\n",
       "      <td>abd allahibrahim1889@yahoo.com</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>18</td>\n",
       "      <td>tamer</td>\n",
       "      <td>hatem</td>\n",
       "      <td>22.0</td>\n",
       "      <td>Industrial Engineering Technicians</td>\n",
       "      <td>Manufacturing Engineering Technologists</td>\n",
       "      <td>6726</td>\n",
       "      <td>NaN</td>\n",
       "      <td>tamerhatem2412@yahoo.com</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>eyad</td>\n",
       "      <td>rami</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Mapping Technicians</td>\n",
       "      <td>Aerospace Engineering and Operations Technicians</td>\n",
       "      <td>3905</td>\n",
       "      <td>tennis</td>\n",
       "      <td>ramieyad4618@gmail.com</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>20</td>\n",
       "      <td>mohamed</td>\n",
       "      <td>samy</td>\n",
       "      <td>36.0</td>\n",
       "      <td>Petroleum Engineers</td>\n",
       "      <td>Photonics Engineers,Robotics Technicians</td>\n",
       "      <td>958,2274,7060</td>\n",
       "      <td>tennis,drawing</td>\n",
       "      <td>mohamedsamy1768@gmail.com</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>21</td>\n",
       "      <td>amera</td>\n",
       "      <td>tarek</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electrical Engineering Technicians</td>\n",
       "      <td>Aerospace Engineers</td>\n",
       "      <td>4549,5678,7522,8137,9237</td>\n",
       "      <td>cooking,swimming</td>\n",
       "      <td>tarekamera6693@gmail.com</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>22</td>\n",
       "      <td>rana</td>\n",
       "      <td>omar</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nanotechnology Engineering Technicians</td>\n",
       "      <td>Electrical Drafters,Drafters, All Other</td>\n",
       "      <td>2374,4290,4332,5816,7332</td>\n",
       "      <td>swimming</td>\n",
       "      <td>ranaomar3156@hotmail.com</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>23</td>\n",
       "      <td>amr</td>\n",
       "      <td>abd allah</td>\n",
       "      <td>73.0</td>\n",
       "      <td>Mapping Technicians</td>\n",
       "      <td>Electronics Engineering Technicians</td>\n",
       "      <td>109,169,2717,2783</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>24</td>\n",
       "      <td>rana</td>\n",
       "      <td>abd allah</td>\n",
       "      <td>76.0</td>\n",
       "      <td>Radio Frequency Identification Device Specialists</td>\n",
       "      <td>Electrical Drafters,Electromechanical Engineer...</td>\n",
       "      <td>1997,6128,7591,8727,9108,9668</td>\n",
       "      <td>gaming,swimming</td>\n",
       "      <td>ranaabd allah4889@yahoo.com</td>\n",
       "      <td>jordanian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>25</td>\n",
       "      <td>sameh</td>\n",
       "      <td>mohamed</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Materials Engineers</td>\n",
       "      <td>Industrial Engineering Technologists</td>\n",
       "      <td>3458,5246,7780</td>\n",
       "      <td>gaming</td>\n",
       "      <td>samehmohamed5011@yahoo.com</td>\n",
       "      <td>jordanian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>26</td>\n",
       "      <td>amar</td>\n",
       "      <td>abd allah</td>\n",
       "      <td>38.0</td>\n",
       "      <td>Surveying and Mapping Technicians</td>\n",
       "      <td>Electronics Engineers, Except Computer,Aerospa...</td>\n",
       "      <td>919,1981,2023,2365,7157,7432,8628,9465</td>\n",
       "      <td>gaming,watching movies</td>\n",
       "      <td>NaN</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>27</td>\n",
       "      <td>omar</td>\n",
       "      <td>hatem</td>\n",
       "      <td>42.0</td>\n",
       "      <td>Environmental Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>576,2477,3334,3881,6083,8340,9735</td>\n",
       "      <td>tennis,reading</td>\n",
       "      <td>NaN</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>28</td>\n",
       "      <td>hatem</td>\n",
       "      <td>ibrahim</td>\n",
       "      <td>59.0</td>\n",
       "      <td>Surveying Technicians</td>\n",
       "      <td>NaN</td>\n",
       "      <td>755,2453,5094,7384</td>\n",
       "      <td>gaming,competitive programming</td>\n",
       "      <td>hatemibrahim550@gmail.com</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>29</td>\n",
       "      <td>Arshd</td>\n",
       "      <td>omar</td>\n",
       "      <td>88.0</td>\n",
       "      <td>Fuel Cell Engineers</td>\n",
       "      <td>Cartographers and Photogrammetrists,Surveying ...</td>\n",
       "      <td>4735</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Arshdomar3537@yahoo.com</td>\n",
       "      <td>syrian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9970</th>\n",
       "      <td>9970</td>\n",
       "      <td>sameh</td>\n",
       "      <td>amr</td>\n",
       "      <td>57.0</td>\n",
       "      <td>Energy Engineers</td>\n",
       "      <td>Surveying and Mapping Technicians</td>\n",
       "      <td>311,2063,2569,3813,9682</td>\n",
       "      <td>competitive programming</td>\n",
       "      <td>samehamr4420@hotmail.com</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9971</th>\n",
       "      <td>9971</td>\n",
       "      <td>ali</td>\n",
       "      <td>amar</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Surveyors</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1314,1709,5290,7315,7956,9786</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>jordanian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9972</th>\n",
       "      <td>9972</td>\n",
       "      <td>mona</td>\n",
       "      <td>mahmoud</td>\n",
       "      <td>61.0</td>\n",
       "      <td>Biochemical Engineers</td>\n",
       "      <td>Electronics Engineering Technicians,Agricultur...</td>\n",
       "      <td>1411,3971,4176</td>\n",
       "      <td>cooking,gaming</td>\n",
       "      <td>monamahmoud5737@gmail.com</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9973</th>\n",
       "      <td>9973</td>\n",
       "      <td>Arshd</td>\n",
       "      <td>rami</td>\n",
       "      <td>75.0</td>\n",
       "      <td>Photonics Engineers</td>\n",
       "      <td>Health and Safety Engineers, Except Mining Saf...</td>\n",
       "      <td>2561,3285,4182,4695,5152,5427,7691,9176</td>\n",
       "      <td>gaming</td>\n",
       "      <td>ramiArshd4913@yahoo.com</td>\n",
       "      <td>syrian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9974</th>\n",
       "      <td>9974</td>\n",
       "      <td>mai</td>\n",
       "      <td>ali</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Computer Hardware Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1971,6398</td>\n",
       "      <td>NaN</td>\n",
       "      <td>alimai6589@gmail.com</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9975</th>\n",
       "      <td>9975</td>\n",
       "      <td>ahmed</td>\n",
       "      <td>eslam</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Surveyors</td>\n",
       "      <td>101,3074,8197,9533,9582</td>\n",
       "      <td>NaN</td>\n",
       "      <td>eslamahmed3922@hotmail.com</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9976</th>\n",
       "      <td>9976</td>\n",
       "      <td>tamer</td>\n",
       "      <td>mazen</td>\n",
       "      <td>53.0</td>\n",
       "      <td>Robotics Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7929</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>syrian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9977</th>\n",
       "      <td>9977</td>\n",
       "      <td>rana</td>\n",
       "      <td>hosny</td>\n",
       "      <td>35.0</td>\n",
       "      <td>Fuel Cell Engineers</td>\n",
       "      <td>Marine Architects,Materials Engineers</td>\n",
       "      <td>6079,6709,7269,8419</td>\n",
       "      <td>cooking,tennis</td>\n",
       "      <td>ranahosny1601@hotmail.com</td>\n",
       "      <td>moroccan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9978</th>\n",
       "      <td>9978</td>\n",
       "      <td>samera</td>\n",
       "      <td>amr</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Mechanical Engineering Technologists</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5939</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>iraqi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9979</th>\n",
       "      <td>9979</td>\n",
       "      <td>amera</td>\n",
       "      <td>mahmoud</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Mining and Geological Engineers, Including Min...</td>\n",
       "      <td>Electrical and Electronic Engineering Technicians</td>\n",
       "      <td>6667,7008,7196,8640</td>\n",
       "      <td>football,camping</td>\n",
       "      <td>ameramahmoud7851@hotmail.com</td>\n",
       "      <td>syrian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9980</th>\n",
       "      <td>9980</td>\n",
       "      <td>nourhan</td>\n",
       "      <td>mahmoud</td>\n",
       "      <td>35.0</td>\n",
       "      <td>Health and Safety Engineers, Except Mining Saf...</td>\n",
       "      <td>Cartographers and Photogrammetrists,Electronic...</td>\n",
       "      <td>2377,3348</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9981</th>\n",
       "      <td>9981</td>\n",
       "      <td>nourhan</td>\n",
       "      <td>ehab</td>\n",
       "      <td>88.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Electrical Engineering Technologists</td>\n",
       "      <td>638,4104,4533,5928,7109,9260,9581</td>\n",
       "      <td>watching movies</td>\n",
       "      <td>nourhanehab2071@gmail.com</td>\n",
       "      <td>jordanian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9982</th>\n",
       "      <td>9982</td>\n",
       "      <td>mai</td>\n",
       "      <td>mahmoud</td>\n",
       "      <td>80.0</td>\n",
       "      <td>Electronics Engineering Technicians</td>\n",
       "      <td>NaN</td>\n",
       "      <td>745,2193,6132,6452,7772</td>\n",
       "      <td>cooking</td>\n",
       "      <td>NaN</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9983</th>\n",
       "      <td>9983</td>\n",
       "      <td>mazen</td>\n",
       "      <td>eyad</td>\n",
       "      <td>18.0</td>\n",
       "      <td>Non-Destructive Testing Specialists</td>\n",
       "      <td>NaN</td>\n",
       "      <td>550,8477,9364</td>\n",
       "      <td>competitive programming,cooking</td>\n",
       "      <td>NaN</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9984</th>\n",
       "      <td>9984</td>\n",
       "      <td>salma</td>\n",
       "      <td>omar</td>\n",
       "      <td>21.0</td>\n",
       "      <td>Mapping Technicians</td>\n",
       "      <td>Electrical and Electronic Engineering Technici...</td>\n",
       "      <td>3178,9201</td>\n",
       "      <td>tennis</td>\n",
       "      <td>salmaomar1700@gmail.com</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9985</th>\n",
       "      <td>9985</td>\n",
       "      <td>yosra</td>\n",
       "      <td>amr</td>\n",
       "      <td>23.0</td>\n",
       "      <td>Mechanical Drafters</td>\n",
       "      <td>Fuel Cell Technicians,Mechanical Engineers</td>\n",
       "      <td>555,2351,2854,4231,5815,8330</td>\n",
       "      <td>NaN</td>\n",
       "      <td>amryosra5537@gmail.com</td>\n",
       "      <td>jordanian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9986</th>\n",
       "      <td>9986</td>\n",
       "      <td>Arshd</td>\n",
       "      <td>amr</td>\n",
       "      <td>80.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Transportation Engineers,Photonics Technicians</td>\n",
       "      <td>1098,5025,6403,7203,7774</td>\n",
       "      <td>NaN</td>\n",
       "      <td>amrArshd1284@yahoo.com</td>\n",
       "      <td>moroccan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9987</th>\n",
       "      <td>9987</td>\n",
       "      <td>mohamed</td>\n",
       "      <td>omar</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nuclear Engineers</td>\n",
       "      <td>Electronic Drafters,Mechanical Engineers</td>\n",
       "      <td>973,1228,1499,1775,3230,3711,5511</td>\n",
       "      <td>competitive programming</td>\n",
       "      <td>omarmohamed7773@gmail.com</td>\n",
       "      <td>jordanian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9988</th>\n",
       "      <td>9988</td>\n",
       "      <td>samera</td>\n",
       "      <td>amar</td>\n",
       "      <td>88.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>301,3658,4218,4256,6564,7401</td>\n",
       "      <td>NaN</td>\n",
       "      <td>amarsamera9715@yahoo.com</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9989</th>\n",
       "      <td>9989</td>\n",
       "      <td>tamer</td>\n",
       "      <td>sameh</td>\n",
       "      <td>41.0</td>\n",
       "      <td>Electronics Engineering Technicians</td>\n",
       "      <td>Health and Safety Engineers, Except Mining Saf...</td>\n",
       "      <td>2056,3582,4720,5181</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>jordanian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9990</th>\n",
       "      <td>9990</td>\n",
       "      <td>maher</td>\n",
       "      <td>rashad</td>\n",
       "      <td>76.0</td>\n",
       "      <td>Aerospace Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9563</td>\n",
       "      <td>competitive programming,football</td>\n",
       "      <td>NaN</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9991</th>\n",
       "      <td>9991</td>\n",
       "      <td>rana</td>\n",
       "      <td>rashad</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nuclear Engineers</td>\n",
       "      <td>Industrial Safety and Health Engineers,Electri...</td>\n",
       "      <td>2649,3187,4159,4996,5919,7406,7771</td>\n",
       "      <td>swimming</td>\n",
       "      <td>ranarashad8603@yahoo.com</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9992</th>\n",
       "      <td>9992</td>\n",
       "      <td>amar</td>\n",
       "      <td>ibrahim</td>\n",
       "      <td>33.0</td>\n",
       "      <td>Radio Frequency Identification Device Specialists</td>\n",
       "      <td>Engineering Technicians, Except Drafters, All ...</td>\n",
       "      <td>176,1765,2220,4272,4397,5641,7330,8525</td>\n",
       "      <td>competitive programming</td>\n",
       "      <td>amaribrahim6308@hotmail.com</td>\n",
       "      <td>jordanian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9993</th>\n",
       "      <td>9993</td>\n",
       "      <td>aya</td>\n",
       "      <td>samir</td>\n",
       "      <td>81.0</td>\n",
       "      <td>Marine Engineers</td>\n",
       "      <td>NaN</td>\n",
       "      <td>161,2237,3571,3825,4006,5607,6265</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>jordanian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9994</th>\n",
       "      <td>9994</td>\n",
       "      <td>salma</td>\n",
       "      <td>amer</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Electrical and Electronic Engineering Technicians</td>\n",
       "      <td>Marine Engineers</td>\n",
       "      <td>2301,3308,4669,6398</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9995</th>\n",
       "      <td>9995</td>\n",
       "      <td>amera</td>\n",
       "      <td>hatem</td>\n",
       "      <td>58.0</td>\n",
       "      <td>Marine Architects</td>\n",
       "      <td>Electrical Drafters,Surveying and Mapping Tech...</td>\n",
       "      <td>15,3753,3994,4890,5043,8141</td>\n",
       "      <td>swimming</td>\n",
       "      <td>amerahatem7217@yahoo.com</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9996</th>\n",
       "      <td>9996</td>\n",
       "      <td>rana</td>\n",
       "      <td>alaa</td>\n",
       "      <td>89.0</td>\n",
       "      <td>Mechanical Drafters</td>\n",
       "      <td>Aerospace Engineering and Operations Technicians</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ranaalaa676@yahoo.com</td>\n",
       "      <td>lebanese</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9997</th>\n",
       "      <td>9997</td>\n",
       "      <td>mai</td>\n",
       "      <td>mazen</td>\n",
       "      <td>63.0</td>\n",
       "      <td>Marine Engineers</td>\n",
       "      <td>Surveying and Mapping Technicians,Electrical a...</td>\n",
       "      <td>336,1704,4396,4452,7784,8237</td>\n",
       "      <td>NaN</td>\n",
       "      <td>mazenmai2695@yahoo.com</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9998</th>\n",
       "      <td>9998</td>\n",
       "      <td>shady</td>\n",
       "      <td>ali</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>430,2070,3326,4764,5274</td>\n",
       "      <td>gaming</td>\n",
       "      <td>shadyali6878@yahoo.com</td>\n",
       "      <td>syrian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9999</th>\n",
       "      <td>9999</td>\n",
       "      <td>aya</td>\n",
       "      <td>magdi</td>\n",
       "      <td>35.0</td>\n",
       "      <td>Electronics Engineers, Except Computer</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6224,6646,7366,8197,8632</td>\n",
       "      <td>drawing,tennis</td>\n",
       "      <td>magdiaya7307@gmail.com</td>\n",
       "      <td>egyptian</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10000 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        ID     firstname      lastname   age  \\\n",
       "0        0         magdi  abd elrahman  35.0   \n",
       "1        1         samir         tamer  84.0   \n",
       "2        2         eslam        rashad  74.0   \n",
       "3        3           ali         eslam   NaN   \n",
       "4        4          ehab         maher   NaN   \n",
       "5        5         yosra       ibrahim   NaN   \n",
       "6        6          mona         Arshd   NaN   \n",
       "7        7         yosra       ibrahim  38.0   \n",
       "8        8           mai         mazen   NaN   \n",
       "9        9         sanaa          samy   NaN   \n",
       "10      10        rashad          amer  33.0   \n",
       "11      11         shady         Arshd  69.0   \n",
       "12      12       ibrahim         tamer  21.0   \n",
       "13      13  abd elrahman         Arshd  31.0   \n",
       "14      14         tamer          ehab  59.0   \n",
       "15      15         yosra         hosny   NaN   \n",
       "16      16       ibrahim         hatem  58.0   \n",
       "17      17       ibrahim     abd allah  50.0   \n",
       "18      18         tamer         hatem  22.0   \n",
       "19      19          eyad          rami   NaN   \n",
       "20      20       mohamed          samy  36.0   \n",
       "21      21         amera         tarek  30.0   \n",
       "22      22          rana          omar   NaN   \n",
       "23      23           amr     abd allah  73.0   \n",
       "24      24          rana     abd allah  76.0   \n",
       "25      25         sameh       mohamed   NaN   \n",
       "26      26          amar     abd allah  38.0   \n",
       "27      27          omar         hatem  42.0   \n",
       "28      28         hatem       ibrahim  59.0   \n",
       "29      29         Arshd          omar  88.0   \n",
       "...    ...           ...           ...   ...   \n",
       "9970  9970         sameh           amr  57.0   \n",
       "9971  9971           ali          amar   NaN   \n",
       "9972  9972          mona       mahmoud  61.0   \n",
       "9973  9973         Arshd          rami  75.0   \n",
       "9974  9974           mai           ali  31.0   \n",
       "9975  9975         ahmed         eslam   NaN   \n",
       "9976  9976         tamer         mazen  53.0   \n",
       "9977  9977          rana         hosny  35.0   \n",
       "9978  9978        samera           amr   NaN   \n",
       "9979  9979         amera       mahmoud  31.0   \n",
       "9980  9980       nourhan       mahmoud  35.0   \n",
       "9981  9981       nourhan          ehab  88.0   \n",
       "9982  9982           mai       mahmoud  80.0   \n",
       "9983  9983         mazen          eyad  18.0   \n",
       "9984  9984         salma          omar  21.0   \n",
       "9985  9985         yosra           amr  23.0   \n",
       "9986  9986         Arshd           amr  80.0   \n",
       "9987  9987       mohamed          omar   NaN   \n",
       "9988  9988        samera          amar  88.0   \n",
       "9989  9989         tamer         sameh  41.0   \n",
       "9990  9990         maher        rashad  76.0   \n",
       "9991  9991          rana        rashad   NaN   \n",
       "9992  9992          amar       ibrahim  33.0   \n",
       "9993  9993           aya         samir  81.0   \n",
       "9994  9994         salma          amer   NaN   \n",
       "9995  9995         amera         hatem  58.0   \n",
       "9996  9996          rana          alaa  89.0   \n",
       "9997  9997           mai         mazen  63.0   \n",
       "9998  9998         shady           ali   NaN   \n",
       "9999  9999           aya         magdi  35.0   \n",
       "\n",
       "                                             currentJob  \\\n",
       "0                     Surveying and Mapping Technicians   \n",
       "1                                                   NaN   \n",
       "2                                   Mapping Technicians   \n",
       "3     Health and Safety Engineers, Except Mining Saf...   \n",
       "4                                   Photonics Engineers   \n",
       "5                                  Validation Engineers   \n",
       "6                                Mechatronics Engineers   \n",
       "7                                      Energy Engineers   \n",
       "8                                                   NaN   \n",
       "9                               Environmental Engineers   \n",
       "10                Marine Engineers and Naval Architects   \n",
       "11                                Biochemical Engineers   \n",
       "12                                   Chemical Engineers   \n",
       "13                                Wind Energy Engineers   \n",
       "14                   Industrial Engineering Technicians   \n",
       "15                       Electro-Mechanical Technicians   \n",
       "16                                                  NaN   \n",
       "17                                Surveying Technicians   \n",
       "18                   Industrial Engineering Technicians   \n",
       "19                                  Mapping Technicians   \n",
       "20                                  Petroleum Engineers   \n",
       "21                   Electrical Engineering Technicians   \n",
       "22               Nanotechnology Engineering Technicians   \n",
       "23                                  Mapping Technicians   \n",
       "24    Radio Frequency Identification Device Specialists   \n",
       "25                                  Materials Engineers   \n",
       "26                    Surveying and Mapping Technicians   \n",
       "27                              Environmental Engineers   \n",
       "28                                Surveying Technicians   \n",
       "29                                  Fuel Cell Engineers   \n",
       "...                                                 ...   \n",
       "9970                                   Energy Engineers   \n",
       "9971                                          Surveyors   \n",
       "9972                              Biochemical Engineers   \n",
       "9973                                Photonics Engineers   \n",
       "9974                        Computer Hardware Engineers   \n",
       "9975                                                NaN   \n",
       "9976                                 Robotics Engineers   \n",
       "9977                                Fuel Cell Engineers   \n",
       "9978               Mechanical Engineering Technologists   \n",
       "9979  Mining and Geological Engineers, Including Min...   \n",
       "9980  Health and Safety Engineers, Except Mining Saf...   \n",
       "9981                                                NaN   \n",
       "9982                Electronics Engineering Technicians   \n",
       "9983                Non-Destructive Testing Specialists   \n",
       "9984                                Mapping Technicians   \n",
       "9985                                Mechanical Drafters   \n",
       "9986                                                NaN   \n",
       "9987                                  Nuclear Engineers   \n",
       "9988                                                NaN   \n",
       "9989                Electronics Engineering Technicians   \n",
       "9990                                Aerospace Engineers   \n",
       "9991                                  Nuclear Engineers   \n",
       "9992  Radio Frequency Identification Device Specialists   \n",
       "9993                                   Marine Engineers   \n",
       "9994  Electrical and Electronic Engineering Technicians   \n",
       "9995                                  Marine Architects   \n",
       "9996                                Mechanical Drafters   \n",
       "9997                                   Marine Engineers   \n",
       "9998                                                NaN   \n",
       "9999             Electronics Engineers, Except Computer   \n",
       "\n",
       "                                               prevJobs  \\\n",
       "0          Agricultural Engineers,Wind Energy Engineers   \n",
       "1               Fuel Cell Engineers,Materials Engineers   \n",
       "2                                                   NaN   \n",
       "3                        Electro-Mechanical Technicians   \n",
       "4               Agricultural Engineers,Marine Engineers   \n",
       "5                                                   NaN   \n",
       "6                Chemical Engineers,Petroleum Engineers   \n",
       "7                                                   NaN   \n",
       "8     Civil Engineers,Nanotechnology Engineering Tec...   \n",
       "9                                                   NaN   \n",
       "10                                 Electrical Engineers   \n",
       "11                                                  NaN   \n",
       "12                                                  NaN   \n",
       "13                                                  NaN   \n",
       "14    Water/Wastewater Engineers,Manufacturing Engin...   \n",
       "15                                                  NaN   \n",
       "16                              Manufacturing Engineers   \n",
       "17    Civil Engineers,Manufacturing Engineering Tech...   \n",
       "18              Manufacturing Engineering Technologists   \n",
       "19     Aerospace Engineering and Operations Technicians   \n",
       "20             Photonics Engineers,Robotics Technicians   \n",
       "21                                  Aerospace Engineers   \n",
       "22              Electrical Drafters,Drafters, All Other   \n",
       "23                  Electronics Engineering Technicians   \n",
       "24    Electrical Drafters,Electromechanical Engineer...   \n",
       "25                 Industrial Engineering Technologists   \n",
       "26    Electronics Engineers, Except Computer,Aerospa...   \n",
       "27                                                  NaN   \n",
       "28                                                  NaN   \n",
       "29    Cartographers and Photogrammetrists,Surveying ...   \n",
       "...                                                 ...   \n",
       "9970                  Surveying and Mapping Technicians   \n",
       "9971                                                NaN   \n",
       "9972  Electronics Engineering Technicians,Agricultur...   \n",
       "9973  Health and Safety Engineers, Except Mining Saf...   \n",
       "9974                                                NaN   \n",
       "9975                                          Surveyors   \n",
       "9976                                                NaN   \n",
       "9977              Marine Architects,Materials Engineers   \n",
       "9978                                                NaN   \n",
       "9979  Electrical and Electronic Engineering Technicians   \n",
       "9980  Cartographers and Photogrammetrists,Electronic...   \n",
       "9981               Electrical Engineering Technologists   \n",
       "9982                                                NaN   \n",
       "9983                                                NaN   \n",
       "9984  Electrical and Electronic Engineering Technici...   \n",
       "9985         Fuel Cell Technicians,Mechanical Engineers   \n",
       "9986     Transportation Engineers,Photonics Technicians   \n",
       "9987           Electronic Drafters,Mechanical Engineers   \n",
       "9988                                                NaN   \n",
       "9989  Health and Safety Engineers, Except Mining Saf...   \n",
       "9990                                                NaN   \n",
       "9991  Industrial Safety and Health Engineers,Electri...   \n",
       "9992  Engineering Technicians, Except Drafters, All ...   \n",
       "9993                                                NaN   \n",
       "9994                                   Marine Engineers   \n",
       "9995  Electrical Drafters,Surveying and Mapping Tech...   \n",
       "9996   Aerospace Engineering and Operations Technicians   \n",
       "9997  Surveying and Mapping Technicians,Electrical a...   \n",
       "9998                                                NaN   \n",
       "9999                                                NaN   \n",
       "\n",
       "                                    friendsID  \\\n",
       "0                               712,6592,7375   \n",
       "1          1139,2309,2767,3343,9150,9533,9845   \n",
       "2                      462,720,3195,3836,4704   \n",
       "3                              1659,3995,6073   \n",
       "4                                   2090,7126   \n",
       "5                                        4220   \n",
       "6                     498,1245,2567,6508,9255   \n",
       "7               2567,3746,4563,5207,9662,9695   \n",
       "8                               992,4719,6870   \n",
       "9                         5150,5842,8582,9426   \n",
       "10                         499,2455,3709,8276   \n",
       "11                         378,2587,3169,4845   \n",
       "12                         689,4954,7664,8520   \n",
       "13                                  1356,3870   \n",
       "14                        1969,2907,6168,9808   \n",
       "15              7339,7687,8055,8987,9648,9995   \n",
       "16                                        NaN   \n",
       "17                        4155,7422,8466,9813   \n",
       "18                                       6726   \n",
       "19                                       3905   \n",
       "20                              958,2274,7060   \n",
       "21                   4549,5678,7522,8137,9237   \n",
       "22                   2374,4290,4332,5816,7332   \n",
       "23                          109,169,2717,2783   \n",
       "24              1997,6128,7591,8727,9108,9668   \n",
       "25                             3458,5246,7780   \n",
       "26     919,1981,2023,2365,7157,7432,8628,9465   \n",
       "27          576,2477,3334,3881,6083,8340,9735   \n",
       "28                         755,2453,5094,7384   \n",
       "29                                       4735   \n",
       "...                                       ...   \n",
       "9970                  311,2063,2569,3813,9682   \n",
       "9971            1314,1709,5290,7315,7956,9786   \n",
       "9972                           1411,3971,4176   \n",
       "9973  2561,3285,4182,4695,5152,5427,7691,9176   \n",
       "9974                                1971,6398   \n",
       "9975                  101,3074,8197,9533,9582   \n",
       "9976                                     7929   \n",
       "9977                      6079,6709,7269,8419   \n",
       "9978                                     5939   \n",
       "9979                      6667,7008,7196,8640   \n",
       "9980                                2377,3348   \n",
       "9981        638,4104,4533,5928,7109,9260,9581   \n",
       "9982                  745,2193,6132,6452,7772   \n",
       "9983                            550,8477,9364   \n",
       "9984                                3178,9201   \n",
       "9985             555,2351,2854,4231,5815,8330   \n",
       "9986                 1098,5025,6403,7203,7774   \n",
       "9987        973,1228,1499,1775,3230,3711,5511   \n",
       "9988             301,3658,4218,4256,6564,7401   \n",
       "9989                      2056,3582,4720,5181   \n",
       "9990                                     9563   \n",
       "9991       2649,3187,4159,4996,5919,7406,7771   \n",
       "9992   176,1765,2220,4272,4397,5641,7330,8525   \n",
       "9993        161,2237,3571,3825,4006,5607,6265   \n",
       "9994                      2301,3308,4669,6398   \n",
       "9995              15,3753,3994,4890,5043,8141   \n",
       "9996                                      NaN   \n",
       "9997             336,1704,4396,4452,7784,8237   \n",
       "9998                  430,2070,3326,4764,5274   \n",
       "9999                 6224,6646,7366,8197,8632   \n",
       "\n",
       "                                              hobbies  \\\n",
       "0     competitive programming,competitive programming   \n",
       "1                                                 NaN   \n",
       "2                                            football   \n",
       "3                                    football,camping   \n",
       "4                                    cooking,swimming   \n",
       "5                                   swimming,football   \n",
       "6                                                 NaN   \n",
       "7                                                 NaN   \n",
       "8                                             cooking   \n",
       "9                                            football   \n",
       "10                            competitive programming   \n",
       "11                                  swimming,swimming   \n",
       "12                                                NaN   \n",
       "13                                    reading,drawing   \n",
       "14                                                NaN   \n",
       "15                                      tennis,tennis   \n",
       "16                            reading,watching movies   \n",
       "17                                    tennis,football   \n",
       "18                                                NaN   \n",
       "19                                             tennis   \n",
       "20                                     tennis,drawing   \n",
       "21                                   cooking,swimming   \n",
       "22                                           swimming   \n",
       "23                                                NaN   \n",
       "24                                    gaming,swimming   \n",
       "25                                             gaming   \n",
       "26                             gaming,watching movies   \n",
       "27                                     tennis,reading   \n",
       "28                     gaming,competitive programming   \n",
       "29                                                NaN   \n",
       "...                                               ...   \n",
       "9970                          competitive programming   \n",
       "9971                                              NaN   \n",
       "9972                                   cooking,gaming   \n",
       "9973                                           gaming   \n",
       "9974                                              NaN   \n",
       "9975                                              NaN   \n",
       "9976                                              NaN   \n",
       "9977                                   cooking,tennis   \n",
       "9978                                              NaN   \n",
       "9979                                 football,camping   \n",
       "9980                                              NaN   \n",
       "9981                                  watching movies   \n",
       "9982                                          cooking   \n",
       "9983                  competitive programming,cooking   \n",
       "9984                                           tennis   \n",
       "9985                                              NaN   \n",
       "9986                                              NaN   \n",
       "9987                          competitive programming   \n",
       "9988                                              NaN   \n",
       "9989                                              NaN   \n",
       "9990                 competitive programming,football   \n",
       "9991                                         swimming   \n",
       "9992                          competitive programming   \n",
       "9993                                              NaN   \n",
       "9994                                              NaN   \n",
       "9995                                         swimming   \n",
       "9996                                              NaN   \n",
       "9997                                              NaN   \n",
       "9998                                           gaming   \n",
       "9999                                   drawing,tennis   \n",
       "\n",
       "                               email nationality  \n",
       "0                                NaN    egyptian  \n",
       "1           samirtamer1626@gmail.com      syrian  \n",
       "2          rashadeslam6970@yahoo.com       iraqi  \n",
       "3             eslamali1859@gmail.com       iraqi  \n",
       "4                                NaN      syrian  \n",
       "5                                NaN    lebanese  \n",
       "6                                NaN    moroccan  \n",
       "7       yosraibrahim4119@hotmail.com    lebanese  \n",
       "8             mazenmai7201@yahoo.com       iraqi  \n",
       "9                                NaN      syrian  \n",
       "10          amerrashad2991@gmail.com    moroccan  \n",
       "11          shadyArshd6821@yahoo.com    lebanese  \n",
       "12        ibrahimtamer1165@gmail.com       iraqi  \n",
       "13                               NaN    lebanese  \n",
       "14                               NaN       iraqi  \n",
       "15          yosrahosny2683@yahoo.com    lebanese  \n",
       "16                               NaN   jordanian  \n",
       "17    abd allahibrahim1889@yahoo.com    egyptian  \n",
       "18          tamerhatem2412@yahoo.com    egyptian  \n",
       "19            ramieyad4618@gmail.com    lebanese  \n",
       "20         mohamedsamy1768@gmail.com    egyptian  \n",
       "21          tarekamera6693@gmail.com       iraqi  \n",
       "22          ranaomar3156@hotmail.com       iraqi  \n",
       "23                               NaN       iraqi  \n",
       "24       ranaabd allah4889@yahoo.com   jordanian  \n",
       "25        samehmohamed5011@yahoo.com   jordanian  \n",
       "26                               NaN    lebanese  \n",
       "27                               NaN    lebanese  \n",
       "28         hatemibrahim550@gmail.com    egyptian  \n",
       "29           Arshdomar3537@yahoo.com      syrian  \n",
       "...                              ...         ...  \n",
       "9970        samehamr4420@hotmail.com    lebanese  \n",
       "9971                             NaN   jordanian  \n",
       "9972       monamahmoud5737@gmail.com       iraqi  \n",
       "9973         ramiArshd4913@yahoo.com      syrian  \n",
       "9974            alimai6589@gmail.com    lebanese  \n",
       "9975      eslamahmed3922@hotmail.com       iraqi  \n",
       "9976                             NaN      syrian  \n",
       "9977       ranahosny1601@hotmail.com    moroccan  \n",
       "9978                             NaN       iraqi  \n",
       "9979    ameramahmoud7851@hotmail.com      syrian  \n",
       "9980                             NaN    lebanese  \n",
       "9981       nourhanehab2071@gmail.com   jordanian  \n",
       "9982                             NaN    lebanese  \n",
       "9983                             NaN    egyptian  \n",
       "9984         salmaomar1700@gmail.com    egyptian  \n",
       "9985          amryosra5537@gmail.com   jordanian  \n",
       "9986          amrArshd1284@yahoo.com    moroccan  \n",
       "9987       omarmohamed7773@gmail.com   jordanian  \n",
       "9988        amarsamera9715@yahoo.com    egyptian  \n",
       "9989                             NaN   jordanian  \n",
       "9990                             NaN    lebanese  \n",
       "9991        ranarashad8603@yahoo.com    lebanese  \n",
       "9992     amaribrahim6308@hotmail.com   jordanian  \n",
       "9993                             NaN   jordanian  \n",
       "9994                             NaN    egyptian  \n",
       "9995        amerahatem7217@yahoo.com    lebanese  \n",
       "9996           ranaalaa676@yahoo.com    lebanese  \n",
       "9997          mazenmai2695@yahoo.com    egyptian  \n",
       "9998          shadyali6878@yahoo.com      syrian  \n",
       "9999          magdiaya7307@gmail.com    egyptian  \n",
       "\n",
       "[10000 rows x 10 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd \n",
    "df = pd.read_csv('./people_data.csv')\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 10000 entries, 0 to 9999\n",
      "Data columns (total 10 columns):\n",
      "ID             10000 non-null int64\n",
      "firstname      10000 non-null object\n",
      "lastname       10000 non-null object\n",
      "age            7181 non-null float64\n",
      "currentJob     8732 non-null object\n",
      "prevJobs       6039 non-null object\n",
      "friendsID      9734 non-null object\n",
      "hobbies        6045 non-null object\n",
      "email          5876 non-null object\n",
      "nationality    10000 non-null object\n",
      "dtypes: float64(1), int64(1), object(8)\n",
      "memory usage: 781.3+ KB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pymongo import MongoClient\n",
    "client = MongoClient('mongodb://localhost:27017')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "__create a `people` database and assign it to `peopleDb` var"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "peopleDb = client[\"people\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['admin', 'config', 'local', 'people']"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "client.list_database_names()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "__add `people_info` collection to `people` database__ and assign it to `peopleInfo`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "peopleInfo = peopleDb[\"people_info\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['people_info']"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "peopleDb.list_collection_names()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "__assign the columns names to `columns` and remove the df after assessing and vis it to save memory__\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "columns = df.columns\n",
    "del df "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "import csv  \n",
    "from pprint import pprint "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "count before inserting 0 \n",
      " inserting... \n",
      "count after inserting 10000 \n"
     ]
    }
   ],
   "source": [
    "peopleInfo.delete_many({})\n",
    "print(\"count before inserting {} \\n inserting... \".format(peopleInfo.count_documents({})))\n",
    "with open('./people_data.csv','r') as file :\n",
    "    reader = csv.DictReader(file, fieldnames=columns)\n",
    "    next(reader) # skipt the header \n",
    "    data = [] \n",
    "    for row in reader:\n",
    "        data.append(dict(row)) \n",
    "peopleInfo.insert_many(data)\n",
    "print(\"count after inserting {} \".format(peopleInfo.count_documents({})))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1- remove all fields with empty values "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "deleted 8703 documents\n"
     ]
    }
   ],
   "source": [
    "c = 0 \n",
    "for i in columns:\n",
    "    c += peopleInfo.count_documents({i:{\"$in\":[\"NaN\",\"nan\",\" \",\"\",None,\"Null\",\"null\"]}})\n",
    "    peopleInfo.delete_many({i:{\"$in\":[\"NaN\",\"nan\",\" \",\"\",None,\"Null\",\"null\"]}})\n",
    "print(\"deleted {} documents\".format(c))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "#uncomment to vis the docs \n",
    "# for doc in peopleInfo.find({}):\n",
    "#     pprint(doc)\n",
    "#     pprint('\\n')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2- change `prevjops` ,` hobbies` and `friendsID`  to array data type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "for field in [\"prevJobs\" , \"hobbies\" , \"friendsID\"]:\n",
    "    for doc in peopleInfo.find({field: {\"$exists\":1}}):\n",
    "        newvalues = { \"$set\": {field: doc[field].split(',')}}\n",
    "        peopleInfo.update_one({\"_id\":doc[\"_id\"]}, newvalues)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "#uncomment to vis \n",
    "# for doc in peopleInfo.find({}):\n",
    "#     print(doc[\"prevJobs\"])\n",
    "#     print('\\n')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3- Find all persons’ document that his `current job` is `his first job` and also his `age` between `20` and` 30 year`"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "__convet `age` to `float` so we can manipulate  with it__"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "str"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(next(peopleInfo.find( { \"age\": { \"$exists\": 1 } } ))[\"age\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "for doc in peopleInfo.find( { \"age\": { \"$exists\": 1 } } ):\n",
    "    peopleInfo.update_one({\"_id\":doc[\"_id\"]},{\"$set\":{\"age\":float(doc[\"age\"])}})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "float"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(next(peopleInfo.find( { \"age\": { \"$exists\": 1 } } ))[\"age\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "for doc in peopleInfo.find({ \"$and\":[{\"currentJob\":{\"$exists\":1}},{\"prevJobs\":{\"$exists\":1}},  { \"age\": { \"$lte\": 30 } }, { \"age\": {\"$gte\":20} }  ] }):\n",
    "        if doc[\"currentJob\"] in doc[\"prevJobs\"]:\n",
    "            #uncomment to vis \n",
    "            #print(doc)\n",
    "            pass"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 4- for each email domain find how many persons using it?\n",
    "__Email domains : yahoo , gmail , hotmail ….etc__"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'_id': 'hotmail', 'count': 446}\n",
      "{'_id': 'yahoo', 'count': 413}\n",
      "{'_id': 'gmail', 'count': 438}\n"
     ]
    }
   ],
   "source": [
    "for i in peopleInfo.aggregate([\n",
    "  { \"$project\" : { \"emailDomains\" : { \"$split\": [\"$email\",\"@\"] }} },\n",
    "    {\"$project\": { \"emailDomains\": {\"$slice\":[\"$emailDomains\",-1]}}},\n",
    "    {\"$unwind\": \"$emailDomains\"}, #so we can split it by . at the next pipline as the [] type will raise an error, in other words this step get the string from an array \n",
    "   { \"$project\" : { \"emailDomains\" : { \"$split\": [\"$emailDomains\",\".\"] }} },\n",
    "    {\"$project\": { \"emailDomains\": {\"$slice\":[\"$emailDomains\",1]}, \"qt\":1}},\n",
    "    {\"$unwind\": \"$emailDomains\"},\n",
    "  { \"$group\" : { \"_id\": \"$emailDomains\" , \"count\" : { \"$sum\" : 1 } } },\n",
    "  { \"$sort\" : { \"total_qty\" : -1 } }\n",
    "]):\n",
    "    print(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 5- for all persons with fullname : `mohamed samir` find all documents of their friends ."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'number of docs is  22 docs '"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "friendsDocs = [] \n",
    "for doc in peopleInfo.aggregate([\n",
    "    {\"$project\": {\"full_name\": {\"$concat\": [\"$firstname\",\" \",\"$lastname\"]}, \"friendsID\":\"$friendsID\"}},\n",
    "    {\"$unwind\":\"$friendsID\"},\n",
    "    {\"$match\": {\"full_name\": \"mohamed samir\"}}\n",
    "]):\n",
    "    friendsDocs.append(peopleInfo.find({\"ID\":doc[\"friendsID\"]}))\n",
    "\"number of docs is  {} docs \".format(len(friendsDocs))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "#uncomment to vis \n",
    "# for i in friendsDocs:\n",
    "#     for j in i:\n",
    "#         print(j)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- note that the above output has just `two` docs out of `22` docs as we preveously removed the docs that contain empty fields at procedure number `one` `1- remove all fields with empty values ` "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 6.1- for all Egyptian persons , how many persons with first name `ahmed`  ? "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "23\n"
     ]
    }
   ],
   "source": [
    "for i in peopleInfo.aggregate([\n",
    "    { \"$match\": {\"firstname\":\"ahmed\", \"nationality\":\"egyptian\"}},\n",
    "    { \"$group\": {\"_id\": \"$firstname\" , \"count\" : { \"$sum\" : 1 } } }\n",
    "]):\n",
    "    print(i[\"count\"])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###  6.2- how many persons `have more than one hobby` ?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "116"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a =  peopleInfo.aggregate([\n",
    "    {\"$match\": { \"nationality\":\"egyptian\"}},\n",
    "    {\"$project\":{\"hobbiesCount\":{\"$size\":\"$hobbies\"}}},\n",
    "    {\"$match\": {\"hobbiesCount\": {\"$gt\":1}} }\n",
    "])\n",
    "len(list(a))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "__but there is a problem that there maybe are some redundant persons so we should group by name at the end__\n",
    "### so:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "109"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a =  peopleInfo.aggregate([\n",
    "    {\"$match\": { \"nationality\":\"egyptian\"}},\n",
    "    {\"$project\":{\"hobbiesCount\":{\"$size\":\"$hobbies\"},  \"name\":{\"$concat\":[\"$firstname\",\" \",\"$lastname\"]}  }},\n",
    "    {\"$match\": {\"hobbiesCount\": {\"$gt\":1}} },\n",
    "    {\"$group\": {\"_id\":\"$name\"}},\n",
    "])\n",
    "len(list(a))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "__note there were 116 - 109 == `7` redundant persons name__"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###  6.3- and  find the `top 5 jobs with respect to number of people working it` "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[{'_id': 'Architects, Except Landscape and Naval', 'count': 8},\n",
       " {'_id': 'Engineers, All Other', 'count': 7},\n",
       " {'_id': 'Architectural Drafters', 'count': 7},\n",
       " {'_id': 'Human Factors Engineers and Ergonomists', 'count': 7},\n",
       " {'_id': 'Non-Destructive Testing Specialists', 'count': 7}]"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list(peopleInfo.aggregate([\n",
    "    {\"$match\": { \"nationality\":\"egyptian\"}},\n",
    "    {\"$group\": {\"_id\":\"$currentJob\", \"count\":{\"$sum\":1}}},\n",
    "    {\"$sort\": {\"count\":-1}},\n",
    "    {\"$limit\":5}\n",
    "]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# conclusion \n",
    "\n",
    "### Personally, I do not see any advantage for MongoDB to make it overcome SQL \"in this particular task\" "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
